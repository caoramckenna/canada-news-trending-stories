"use strict";function IntentIqSyncObject(t){this.version=5.082,this.wasDebugCheck=!1,this.isDebugMode=!1,this.localStorageEnabled=void 0,this.metadataConstant=256,this.syncRefreshMillis=36e5,this.intentIqConfig={partner:t?t.partner:null,iiqPixelServerAddress:t&&"string"==typeof t.iiqPixelServerAddress?t.iiqPixelServerAddress:"https://sync.intentiq.com",sourceMetaData:t&&"string"==typeof t.sourceMetaData?this.translateMetadata(t.sourceMetaData):this.translateMetadata(""),partnerClientId:t&&"string"==typeof t.partnerClientId?t.partnerClientId:"",partnerClientIdType:t&&"number"==typeof t.partnerClientIdType?this.verifyIdType(t.partnerClientIdType):-1,domainName:t&&"string"==typeof t.domainName?t.domainName:""},this.intentIqConfig.lsKeys={FIRST_PARTY_KEY:"_iiq_fdata",LAST_SYNC_KEY:"_iiq_sync_"+this.intentIqConfig.partner},this.firstPartyData=this.loadOrCreateFirstPartyData(),this.pixelSync()}IntentIqSyncObject.prototype.translateMetadata=function(t){try{var e=t.split(".");return((+e[0]*this.metadataConstant+ +e[1])*this.metadataConstant+ +e[2])*this.metadataConstant+ +e[3]}catch(t){return NaN}},IntentIqSyncObject.prototype.isDebug=function(){var t;return this.wasDebugCheck||(-1===(t=window.location.href).indexOf("?debug=true")&&-1===t.indexOf("&debug=")||(this.isDebugMode=!0),this.wasDebugCheck=!0),this.isDebugMode},IntentIqSyncObject.prototype.logger=function(t){this.isDebug()&&console.log(this.intentIqConfig.partner+"  %c"+t,"color: yellow ; background-color: blue; border-radius: 3px")},IntentIqSyncObject.prototype.createPixelUrl=function(){var t=this.intentIqConfig.iiqPixelServerAddress+"/profiles_engine/ProfilesEngineServlet?at=20&mi=10&secure=1";return t+="&dpi="+this.intentIqConfig.partner,t=this.appendFirstPartyDataToUrl(t),t=this.addUniquenessToUrl(t),t=this.appendPartnersFirsyParty(t),t=this.appendReferrerToUrl(t),t=this.addMetaData(t),t+=this.version?"&jsver="+encodeURIComponent(this.version):""},IntentIqSyncObject.prototype.addMetaData=function(t){return isNaN(this.intentIqConfig.sourceMetaData)||(t+="&fbp="+this.intentIqConfig.sourceMetaData),t},IntentIqSyncObject.prototype.addUniquenessToUrl=function(t){return t+="&tsrnd="+Math.floor(1e3*Math.random())+"_"+(new Date).getTime()},IntentIqSyncObject.prototype.appendPartnersFirsyParty=function(t){try{if(-1===this.intentIqConfig.partnerClientIdType)return t;""!==this.intentIqConfig.partnerClientId&&(t=(t=t+"&pcid="+this.intentIqConfig.partnerClientId)+"&idtype="+this.intentIqConfig.partnerClientIdType)}catch(t){this.logger(t)}return t},IntentIqSyncObject.prototype.appendFirstPartyDataToUrl=function(t){return t=(t=(t=(t+=this.firstPartyData.pid?"&pid="+encodeURIComponent(this.firstPartyData.pid):"")+(this.firstPartyData.dbsaved?"&dbsaved="+encodeURIComponent(this.firstPartyData.dbsaved):""))+(this.firstPartyData.pcid?"&iiqidtype=2&iiqpcid="+encodeURIComponent(this.firstPartyData.pcid):""))+(this.firstPartyData.pcidDate?"&iiqpciddate="+encodeURIComponent(this.firstPartyData.pcidDate):"")},IntentIqSyncObject.prototype.appendReferrerToUrl=function(t){var e="";return this.intentIqConfig&&this.intentIqConfig.domainName&&""!=this.intentIqConfig.domainName?e=this.intentIqConfig.domainName:document.referrer&&""!==document.referrer&&(e=document.referrer),t+="&vrref="+encodeURIComponent(e)},IntentIqSyncObject.prototype.verifyIdType=function(t){return 0===t||1===t||3===t||4===t?t:-1},IntentIqSyncObject.prototype.loadOrCreateFirstPartyData=function(){var t=this.tryParse(this.readData(this.intentIqConfig.lsKeys.FIRST_PARTY_KEY));return t&&t.pcid?t&&!t.pcidDate&&(t.pcidDate=Date.now(),this.storeData(this.intentIqConfig.lsKeys.FIRST_PARTY_KEY,JSON.stringify(t))):(t={pcid:this.generateGUID(),pcidDate:Date.now()},this.storeData(this.intentIqConfig.lsKeys.FIRST_PARTY_KEY,JSON.stringify(t))),t},IntentIqSyncObject.prototype.tryParse=function(t){try{return JSON.parse(t)}catch(t){this.logger(t)}return null},IntentIqSyncObject.prototype.readData=function(t){try{if(this.hasLocalStorage())return window.localStorage.getItem(t)}catch(t){this.logger(t)}return null},IntentIqSyncObject.prototype.generateGUID=function(){var n=(new Date).getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var e=(n+16*Math.random())%16|0;return n=Math.floor(n/16),("x"===t?e:3&e|8).toString(16)})},IntentIqSyncObject.prototype.storeData=function(t,e){try{"string"==typeof t&&t.startsWith("iiq_fdata")&&this.logger("IntentIQ: storing data: key="+t+" value="+e),this.isDefined(e)&&this.hasLocalStorage()&&window.localStorage.setItem(t,e)}catch(t){this.logger(t)}},IntentIqSyncObject.prototype.hasLocalStorage=function(){if(void 0!==this.localStorageEnabled)return this.localStorageEnabled;try{return this.localStorageEnabled=!!window.localStorage,this.localStorageEnabled}catch(t){this.localStorageEnabled=!1,this.logger("Local storage api disabled")}return!1},IntentIqSyncObject.prototype.isDefined=function(t){return void 0!==t&&null!=t},IntentIqSyncObject.prototype.pixelSync=function(){try{var t,e=parseInt(this.readData(this.intentIqConfig.lsKeys.LAST_SYNC_KEY));(!e||Date.now()-e>this.syncRefreshMillis)&&(t=this.createPixelUrl(),this.appendImage(t),this.storeData(this.intentIqConfig.lsKeys.LAST_SYNC_KEY,Date.now()+""))}catch(t){this.logger("Error adding pixel to DOM "+t)}},IntentIqSyncObject.prototype.appendImage=function(t){var e;this.isDefined(t)&&((e=document.createElement("img")).src=t,e.width=1,e.height=1,this.isDefined(document.body)?document.body.appendChild(e):window.addEventListener("load",function(){try{document.body.appendChild(e)}catch(t){}}))};